<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>FakeGPT Lab - Stefenmarg</title><meta name="description" content="Lab caterogy: Malware Analysis Lab can be found here. For this lab we were given the following scenario: Your cybersecurity team has been alerted to suspicious activity on your organization’s network. Several employees reported unusual behavior in their browsers after installing what they believed to&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-0ZK0YCNLYC"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-0ZK0YCNLYC' );</script><link rel="canonical" href="https://stefenmarg.github.io/fakegpt-lab/"><link rel="alternate" type="application/atom+xml" href="https://stefenmarg.github.io/feed.xml" title="Stefenmarg - RSS"><link rel="alternate" type="application/json" href="https://stefenmarg.github.io/feed.json" title="Stefenmarg - JSON"><meta property="og:title" content="FakeGPT Lab"><meta property="og:site_name" content="Stefenmarg"><meta property="og:description" content="Lab caterogy: Malware Analysis Lab can be found here. For this lab we were given the following scenario: Your cybersecurity team has been alerted to suspicious activity on your organization’s network. Several employees reported unusual behavior in their browsers after installing what they believed to&hellip;"><meta property="og:url" content="https://stefenmarg.github.io/fakegpt-lab/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://stefenmarg.github.io/assets/css/style.css?v=7903310e5465b04f86f58317d2b01f87"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://stefenmarg.github.io/fakegpt-lab/"},"headline":"FakeGPT Lab","datePublished":"2025-01-24T12:00+02:00","dateModified":"2025-05-30T10:26+03:00","description":"Lab caterogy: Malware Analysis Lab can be found here. For this lab we were given the following scenario: Your cybersecurity team has been alerted to suspicious activity on your organization’s network. Several employees reported unusual behavior in their browsers after installing what they believed to&hellip;","author":{"@type":"Person","name":"Stefanos M.","url":"https://stefenmarg.github.io/authors/stefanos-m/"},"publisher":{"@type":"Organization","name":"Stefanos M."}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><header class="top js-header"><a class="logo" href="https://stefenmarg.github.io/">Stefenmarg</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://stefenmarg.github.io/" target="_self">Home</a></li><li><a href="https://stefenmarg.github.io/about-me/" target="_self">About Me</a></li><li><a href="https://stefenmarg.github.io/tags/posts/" target="_self">Posts</a></li><li><a href="https://stefenmarg.github.io/tags/projects/" target="_self">Projects</a></li><li class="has-submenu"><a href="https://stefenmarg.github.io/tags/cyber-security/" target="_self" aria-haspopup="true">Cyber Security</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://stefenmarg.github.io/tags/hackthebox/" target="_self">HackTheBox</a></li><li><a href="https://stefenmarg.github.io/tags/tryhackme/" target="_self">TryHackMe</a></li><li><a href="https://stefenmarg.github.io/tags/cyberdefenders/" target="_self">CyberDefenders</a></li></ul></li><li><a href="https://stefenmarg.github.io/tags/" target="_self">Tags</a></li></ul></nav></header><main class="post"><article class="content"><div class="hero hero--noimage"><header class="hero__content"><div class="wrapper"><h1>FakeGPT Lab</h1><div class="feed__meta content__meta"><img src="https://www.gravatar.com/avatar/40d287f9095838f5d7b139df59071b54?s&#x3D;240" loading="eager" height="240" width="240" class="feed__author-thumb" alt=""> <a href="https://stefenmarg.github.io/authors/stefanos-m/" class="feed__author">Stefanos M.</a> <time datetime="2025-01-24T12:00" class="feed__date">January 24, 2025</time></div></div></header></div><div class="entry-wrapper content__entry"><h4 id="lab-caterogy-malware-analysis">Lab caterogy: Malware Analysis</h4><p>Lab can be found <a href="https://cyberdefenders.org/blueteam-ctf-challenges/fakegpt/">here.</a></p><p>For this lab we were given the following scenario:</p><blockquote><p>Your cybersecurity team has been alerted to suspicious activity on your organization’s network. Several employees reported unusual behavior in their browsers after installing what they believed to be a helpful browser extension named “ChatGPT”. However, strange things started happening: accounts were being compromised, and sensitive information appeared to be leaking.</p></blockquote><blockquote><p>Your task is to perform a thorough analysis of this extension identify its malicious components.</p></blockquote><p>After downloading the archive file for the extension and unzipping it with the password provided we get greeted with the enviroment that we are going to investigate. To see the extension’s files I opened the folder with VSCode.</p><h5 id="q1-which-encoding-method-does-the-browser-extension-use-to-obscure-target-urls-making-them-more-difficult-to-detect-during-analysis">Q1: Which encoding method does the browser extension use to obscure target URLs, making them more difficult to detect during analysis?</h5><p>In this part it appears that the function is not actually used in the code, whether this is intentional or not I do not know but we can still solve this questions.</p><p>For this question we can rule out the following files:</p><ul><li><code>manifest.json</code></li><li><code>ui.html</code></li><li><code>img.GIF</code></li></ul><p>Since we are looking into obscuring something we can also rule out the <code>crypto.js</code> file since all it does is AES Encrypt a string with a key. With the 2 remaining files <code>loader.js</code> and <code>app.js</code> all we have to do is search for a function that decodes something. After simply looking through the 2 files we can see the existance of a base64 string thus maarking Q1 complete with the answer bring <code>base64</code>.</p><pre><code class="language-JavaScript">const targets = [_0xabc1(&#39;d3d3LmZhY2Vib29rLmNvbQ==&#39;)];
</code></pre><h5 id="q2-which-website-does-the-extension-monitor-for-data-theft-targeting-user-accounts-to-steal-sensitive-information">Q2: Which website does the extension monitor for data theft, targeting user accounts to steal sensitive information?</h5><p>If we were to search for regular urls in these files we would find just an image source link which is not a site that someone wuld really want to monitor so it must be hidden. What if we were to take the string found above in the <code>targets</code> constant and decode it from <code>base64</code> what would it return?</p><pre><code class="language-Bash">echo &quot;d3d3LmZhY2Vib29rLmNvbQ==&quot; | base64 -d
www.facebook.com
</code></pre><p>Thus like that we were able to get what the target website actually was for Q2. Genuine question, is <code>www.facebook.com</code> really used in 2025?</p><h5 id="q3-which-type-of-html-element-is-utilized-by-the-extension-to-send-stolen-data">Q3: Which type of HTML element is utilized by the extension to send stolen data?</h5><p>This is pretty easy since the function that gets the element to load is in the same file with the above questions. Just following the call stuck after the variable of the above questions we go to the function that uses the html element: <code>if</code> &gt; <code>exfiltrateCredentials(username, password)</code> &gt; <code>sendToServer</code> thus seeing that the utilised element is and <code>img</code> element.</p><h5 id="q4-what-is-the-first-specific-condition-in-the-code-that-triggers-the-extension-to-deactivate-itself">Q4: What is the first specific condition in the code that triggers the extension to deactivate itself?</h5><p>If we stroll again through the files again we can propably see an alert in the <code>loader.js</code> file that disables the extension thus making the answer to the forth question that is <code>navigator.plugins.length === 0</code>.</p><h5 id="q5-which-event-does-the-extension-capture-to-track-user-input-submitted-through-forms">Q5: Which event does the extension capture to track user input submitted through forms?</h5><p>This answer can be simply found with the search option and we get 2 results in the <code>.addEventListener()</code> attribute. Since the question below is about keystrokes and the events found are either <code>submit</code> or <code>keydown</code> this is propably the <code>submit</code> event.</p><h5 id="q6-which-api-or-method-does-the-extension-use-to-capture-and-monitor-user-keystrokes">Q6: Which API or method does the extension use to capture and monitor user keystrokes?</h5><p>As mentioned above the only remaining event is the <code>keydown</code> thus marking question 6 solved.</p><h5 id="q7-what-is-the-domain-where-the-extension-transmits-the-exfiltrated-data">Q7: What is the domain where the extension transmits the exfiltrated data?</h5><p>Do you remember in Q2 the other url <code>https://Mo.Elshaheedy.com/</code> found that is supposed to load an image? Well that was the domain that is the answer to this question.</p><h5 id="q8-which-function-in-the-code-is-used-to-exfiltrate-user-credentials-including-the-username-and-password">Q8: Which function in the code is used to exfiltrate user credentials, including the username and password?</h5><p>Keyword from the question <code>exfiltrate</code> if we simply search this we get 2 functions of which one is the answer to the above question. Since we are talking about creadentials though we are talking about the <code>exfiltrateCredentials(username, password)</code> function.</p><h5 id="q9-which-encryption-algorithm-is-applied-to-secure-the-data-before-sending">Q9: Which encryption algorithm is applied to secure the data before sending?</h5><p>Do you remember in Q1 that we ruled out <code>Crypto.js</code>, well it is time for us to see what it contains and find the algorithm that it uses. On the <code>6th line</code> we can see that we are dealing with the <code>AES</code> algorithm thus marking this question complete too.</p><h5 id="q10-what-does-the-extension-access-to-store-or-manipulate-session-related-data-and-authentication-information">Q10: What does the extension access to store or manipulate session-related data and authentication information?</h5><p>Final question that cannot be found on the js files, simply browsing all the files from scratch and watching extension permissions we can finally see that we are dealing with <code>cookies</code>!</p><h5 id="closing-statement">Closing statement</h5><p>I have to say that this lab was supper fun, it was my first time diving into the code of an extension. Seeing what an extension is really capable to do is scary to be honest. As rated in the ite after the completion for me it is 100% a 5/5 stars lab.</p></div><footer class="content__footer"><div class="entry-wrapper"><p class="content__updated">This article was updated on May 30, 2025</p><div class="content__actions"><ul class="content__tag"><li><a href="https://stefenmarg.github.io/tags/cyber-security/">Cyber-security</a></li><li><a href="https://stefenmarg.github.io/tags/cyberdefenders/">CyberDefenders</a></li><li><a href="https://stefenmarg.github.io/tags/old-posts/">Old-Posts</a></li></ul></div></div></footer></article></main><footer class="footer"><div class="wrapper"><div class="footer__copyright"><p>© 2024–2025 Stefenmarg. All rights reserved.<br>Powered by Publii</p></div><div class="footer__social"><a href="https://twitter.com/stefenmarg" aria-label="X"><svg><use xlink:href="https://stefenmarg.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://instagram.com/stefenmarg" aria-label="Instagram"><svg><use xlink:href="https://stefenmarg.github.io/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/stefenmarg/" aria-label="LinkedIn"><svg><use xlink:href="https://stefenmarg.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div><button id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg width="20" height="20"><use xlink:href="https://stefenmarg.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></div></footer><script defer="defer" src="https://stefenmarg.github.io/assets/js/scripts.min.js?v=ffcbea6c02c8178d10092962b235a5b0"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>